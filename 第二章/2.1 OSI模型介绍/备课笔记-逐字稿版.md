# 第二章 2.1 OSI七层模型介绍 - 备课笔记（逐字稿版）

## 课程信息
- **课程名称**：传感器网络技术与应用
- **章节**：第2章 2.1 OSI七层模型介绍
- **课时**：2课时（100分钟）
- **学生背景**：尚未学习《计算机网络》课程

---

# 第一课时（50分钟）

---

## 一、课程引入（5分钟）

**【翻到第1页】**

同学们好，今天我们开始学习第二章的内容——传感器网络的协议架构及关键技术。

在开始之前，我想先问大家一个问题：**你们平时是怎么和朋友交流的？**

对，可以发微信、打电话、发邮件。那你们有没有想过，当你发一条微信消息的时候，这条消息是怎么从你的手机传到朋友的手机上的？

这个过程其实非常复杂。你的手机需要和服务器通信，服务器再把消息转发给你朋友的手机。这中间涉及到很多步骤：消息怎么打包、怎么加密、走哪条路、怎么避免出错……

为了让这些步骤有条不紊地进行，计算机科学家们设计了一套规则，叫做**网络协议**。而为了让协议的设计更加清晰、模块化，他们又提出了**分层**的思想。

今天我们要学习的就是网络协议最经典的分层模型——**OSI七层模型**。

**【翻到第2页】**

大家看这一页，这是第二章的整体内容。今天我们只讲2.1节，也就是OSI七层模型介绍。学完这一节，大家就能理解网络通信的基本框架，为后面学习物理层、数据链路层、网络层等具体协议打下基础。

---

## 二、OSI模型概述（10分钟）

**【翻到第3页】**

好，我们正式开始。首先来看OSI七层模型是什么。

OSI是Open Systems Interconnection的缩写，翻译过来叫"开放系统互联"。这里的"开放"是什么意思呢？就是说这个标准是公开的，任何厂商都可以按照这个标准来设计自己的设备和软件，这样不同厂商的产品就能互相通信了。

这个模型是1984年由ISO——国际标准化组织提出的。注意ISO和OSI不要搞混了：ISO是组织的名字，OSI是模型的名字。

**那为什么要提出这个模型呢？**

大家想象一下，在早期的计算机网络时代，每个厂商都有自己的一套通信方式。IBM的电脑只能和IBM的电脑通信，苹果的只能和苹果的通信，非常不方便。就好像每个国家都说自己的语言，互相听不懂。

所以ISO就提出了OSI模型，作为一个统一的参考框架。有了这个框架，大家按照同样的规则来设计，不同厂商的设备就能无缝通信了。

**OSI模型把网络通信分成了七层**：从下到上依次是物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。

这七层是互相独立的，每一层都有自己特定的功能和协议。这样设计有什么好处呢？我们往下看。

**【翻到第4页】**

这一页列出了OSI模型的特点，我来解释一下：

**第一，易于理解和设计**。把复杂的网络通信拆分成七个相对简单的层，每层只需要关注自己的职责，设计起来就容易多了。

**第二，易于维护**。如果网络出了问题，我们可以一层一层地排查，很快就能定位到是哪一层出了问题。比如网页打不开，我们可以先检查物理连接有没有问题，再检查IP地址对不对，一步步来。

**第三，保证厂商互通**。只要大家都遵循同样的标准，华为的路由器就能和思科的交换机一起工作，小米的手机就能连接苹果的热点。

**第四，各层独立**。每一层的改动不会影响其他层。比如我们把有线网络换成无线网络，只需要改物理层，上面的软件不需要改动。

**第五，故障隔离**。某一层出问题时，不会影响其他层。就像汽车的发动机坏了，不会影响到方向盘的功能。

这些特点都非常重要，也是我们学习分层思想的原因。

---

**【类比讲解：快递系统】**

为了帮助大家更好地理解分层的思想，我用一个大家都熟悉的例子来类比——**快递寄送**。

假设你要从北京给上海的朋友寄一本书。这个过程是怎样的呢？

**第一步**，你把书包好，写上收件人的地址。这就相当于**应用层**——准备要发送的内容。

**第二步**，你可能会用信封装起来，写清楚格式。这就相当于**表示层**——统一格式。

**第三步**，你打电话确认朋友在家能收件。这就相当于**会话层**——确认通信可以进行。

**第四步**，你选择用顺丰还是圆通。这就相当于**传输层**——选择可靠的还是便宜快速的传输方式。顺丰就像TCP，贵但可靠；某些小快递就像UDP，便宜但可能丢件。

**第五步**，快递公司规划路线，先到石家庄，再到济南，再到南京，最后到上海。这就相当于**网络层**——路由寻址。

**第六步**，每一站的交接，从北京仓库搬上卡车，到石家庄卸下来换辆车。这就相当于**数据链路层**——每一跳的可靠传输。

**第七步**，卡车、火车、飞机实际在路上跑。这就相当于**物理层**——实际的比特流传输。

通过这个类比，大家应该能理解为什么要分层了。**作为发件人，你只需要写好地址交给快递员，不需要关心中间怎么运输**。同样，应用程序只需要把数据交给下一层，不需要关心底层怎么传输。这就是分层的好处。

---

**【翻到第5页】**

这一页简单介绍了通信领域的几个主要标准化组织：

**ISO**，我们刚才说了，提出了OSI模型。

**IEEE**，电气与电子工程师协会，他们制定了很多我们熟悉的标准，比如WiFi标准（802.11）、Zigbee的底层标准（802.15.4）。

**ITU**，国际电信联盟，是联合国下属的机构，主要负责引导移动通信标准，比如3G、4G、5G的总体框架。

**3GPP**，第三代合作伙伴计划，专门制定移动通信的详细规范，从3G到现在的6G都是他们在做。

这些组织大家了解一下就行。重点是IEEE 802.15.4，这是Zigbee的基础，和我们后面学的无线传感器网络密切相关。

---

## 三、七层模型详解（上）（30分钟）

**【翻到第6页】**

好，现在我们来详细学习七层模型的每一层。

大家看这张图，这是OSI七层模型的经典结构图。从下到上分别是：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。

为了方便记忆，大家可以记一个口诀：**"物数网传会表应"**。物理、数据链路、网络、传输、会话、表示、应用。

今天第一课时我们先学习**上四层**：应用层、表示层、会话层、传输层。这四层主要关注数据的处理和端到端的传输。

下节课我们再学习**下三层**：网络层、数据链路层、物理层。这三层主要关注数据在网络中的实际传输。

---

**【翻到第7页：应用层】**

首先是最上面的**应用层**。

应用层是用户直接接触的层，它为应用程序提供网络服务。

**什么意思呢？**

当你打开浏览器访问网页时，浏览器这个应用程序需要从服务器获取网页内容。应用层就负责告诉网络"我要获取这个网页"，然后把服务器返回的内容交给浏览器显示。

应用层有很多协议，都是大家熟悉的：
- **HTTP**：用于访问网页
- **FTP**：用于传输文件
- **SMTP**：用于发送邮件
- **DNS**：用于把域名（如baidu.com）转换成IP地址

应用层有一个重要特点：**它不关心数据是怎么传输的**。它只负责"我要什么数据"或者"我要发送什么数据"，具体怎么传，交给下面的层去处理。

就像你寄快递时只需要告诉快递员"把这个包裹送到上海"，不需要关心快递公司内部怎么运作。

---

**【翻到第8页：表示层】**

接下来是**表示层**。

表示层的主要功能是确保数据能够被接收方正确理解。它做三件事：

**第一，格式化**。把数据转换成标准格式。比如你发一张图片，表示层会把它编码成JPEG或PNG格式，这样对方才能正确显示。

**第二，加密**。保护数据安全。比如你访问银行网站时，URL前面有个HTTPS，这个S就代表安全，表示层会对数据进行加密，防止被窃取。

**第三，压缩**。减少数据量，提高传输效率。比如网页内容在传输前会被压缩，到达后再解压。

在传感器网络中，表示层的功能也很重要。传感器采集的数据通常需要压缩以节省能量，敏感数据也需要加密以保证安全。

---

**【翻到第9页：会话层】**

然后是**会话层**。

会话层负责建立、管理和终止通信会话。

**什么是会话呢？**

打电话就是一个典型的会话。你拨号，对方接通，这就是**建立会话**。然后你们开始聊天，这是**会话进行中**。最后挂断电话，这就是**终止会话**。

会话层还有一个重要功能是**数据同步**。比如你下载一个大文件，下到一半网络断了。有了会话层的同步功能，网络恢复后可以从断点继续下载，而不用从头开始。这就是大家熟悉的"断点续传"。

不过我要说明一点：在现代的TCP/IP协议中，会话层的功能通常被合并到应用层或传输层了。所以在实际应用中，会话层不是很明显。但作为OSI参考模型的一部分，我们还是要了解它的概念。

---

**【翻到第10页：传输层】**

现在到了非常重要的一层——**传输层**。

传输层是一个**承上启下**的关键层。它向上为应用层提供服务，向下利用网络层的功能。它的核心任务是提供**端到端**的数据传输服务。

传输层做几件重要的事：

**第一，数据分段与重组**。如果要发送的数据很大，传输层会把它切成小段分别发送，接收方再把小段组装成完整的数据。

**第二，流量控制**。如果发送方发太快，接收方处理不过来，传输层会让发送方慢一点。

**第三，错误检测与纠正**。如果数据在传输过程中出错了，传输层能发现并要求重传。

传输层最重要的两个协议是**TCP**和**UDP**。这是一个重点，我要详细讲一下。

---

**【TCP vs UDP 详细讲解】**

**TCP**，全称Transmission Control Protocol，传输控制协议。

TCP的特点是**面向连接、可靠传输**。什么意思呢？

"面向连接"是说，在发送数据之前，发送方和接收方要先建立连接，确认双方都准备好了，然后才开始传数据。传完之后再断开连接。

"可靠传输"是说，TCP会确保数据完整无误地到达。如果某个数据包丢了或者出错了，TCP会重新发送，直到对方确认收到为止。

TCP适合什么场景呢？需要数据准确完整的场景，比如**网页浏览、电子邮件、文件下载**。你下载一个软件，少一个字节都不行，必须完整。

---

**UDP**，全称User Datagram Protocol，用户数据报协议。

UDP的特点是**无连接、不可靠**。

"无连接"是说，发送方不需要事先和接收方建立连接，拿起来就发。

"不可靠"不是贬义词，而是说UDP不保证数据一定能到达。它采用"尽力而为"的方式，发出去就不管了。

那UDP有什么好处呢？**快**。因为不需要建立连接，不需要等待确认，所以速度快、延迟低。

UDP适合什么场景呢？**实时性要求高、允许少量丢失**的场景，比如**视频直播、语音通话、在线游戏**。看直播时偶尔卡一下没关系，但如果画面延迟几秒就很难受了。

---

**【TCP三次握手】**

TCP建立连接的过程叫做**三次握手**，这是一个经典的知识点。

我用打电话来类比：

**第一次握手**：你打电话过去，说"喂，能听到吗？"
在TCP中，这就是客户端发送SYN包，请求建立连接。

**第二次握手**：对方说"能听到，你能听到我吗？"
在TCP中，这就是服务器回复SYN+ACK包，表示同意连接并确认收到。

**第三次握手**：你说"能听到，开始说吧。"
在TCP中，这就是客户端发送ACK包，确认收到对方的回复。

三次握手之后，双方都确认对方能正常收发数据，连接就建立了。

**有同学可能会问：为什么要三次？两次不行吗？**

两次不行。假设只有两次，服务器收到客户端的请求后就认为连接建立了。但如果客户端发的请求在网络中延迟了很久才到达，客户端可能早就放弃了。这时服务器建立了一个"僵尸连接"，浪费资源。三次握手可以避免这个问题。

---

## 四、第一课时小结（5分钟）

好，今天第一课时的内容就讲到这里。我们来总结一下：

**第一**，OSI七层模型是网络协议的参考框架，由ISO在1984年提出。它把网络通信分成七层，每层各司其职，便于设计和维护。

**第二**，我们学习了上四层的功能：
- **应用层**：直接为应用程序提供服务，如HTTP、FTP
- **表示层**：格式转换、加密、压缩
- **会话层**：建立、管理、终止会话
- **传输层**：端到端传输，TCP（可靠）和UDP（快速）

**第三**，TCP和UDP是传输层最重要的两个协议。TCP面向连接、可靠但慢；UDP无连接、不可靠但快。TCP通过三次握手建立连接。

下节课我们将继续学习下三层：网络层、数据链路层、物理层。大家下课后可以想想：**IP地址和MAC地址有什么区别？路由器和交换机有什么区别？**

好，下课。

---

# 第二课时（50分钟）

---

## 五、回顾与衔接（5分钟）

同学们好，我们继续上节课的内容。

先来回顾一下。上节课我们学习了OSI七层模型的基本概念和上四层的功能。

**我来问几个问题**：

OSI七层模型从下到上分别是哪七层？
（等待回答）对，物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。记住口诀"物数网传会表应"。

TCP和UDP的主要区别是什么？
（等待回答）对，TCP面向连接、可靠但慢；UDP无连接、不可靠但快。

好，上节课我们学了上四层，知道传输层负责端到端的数据传输。但是，数据是怎么在网络中找到目的地的呢？一台电脑发出的数据包，怎么穿越千山万水，准确到达另一台电脑呢？

这就需要下三层来完成。今天我们来学习**网络层、数据链路层和物理层**。

---

## 六、七层模型详解（下）（25分钟）

**【翻到第11页：网络层】**

首先是**网络层**，这也是一个非常重要的层。

网络层的核心功能是在不同网络之间实现数据包的传输。它要解决的问题是：**数据包从源头到目的地，应该走哪条路？**

网络层做三件重要的事：

**第一，逻辑寻址**。网络层使用**IP地址**来标识网络中的每一台设备。IP地址就像家庭住址一样，是设备在网络中的"门牌号"。

**第二，路由**。网络层要找到从源到目的地的最佳路径。这就像你用导航软件规划路线，选择最快或最短的路。

**第三，分组转发**。路由器根据数据包的目的IP地址和路由表，把数据包转发到下一站。

---

**【IP地址详解】**

我来详细讲一下IP地址。

**IP地址**是网络层用来标识设备的地址。目前主要有两个版本：

**IPv4**：由32位二进制组成，通常写成四个十进制数，用点分隔，比如192.168.1.1。IPv4最多能表示大约43亿个地址，听起来很多，但随着互联网的发展，已经不够用了。

**IPv6**：由128位组成，能表示的地址数量是天文数字，基本上给地球上每一粒沙子都能分配一个地址。IPv6正在逐步推广。

IP地址有一个重要特点：**它是逻辑地址，可以改变**。你的电脑连接不同的网络，IP地址可能不同。这和后面要讲的MAC地址不一样。

---

**【路由详解】**

再来说说路由。

**路由器**是网络层的核心设备。它的工作就是根据目的IP地址，决定数据包应该从哪个端口转发出去。

路由器内部有一张**路由表**，记录着"要去某个目的地，应该走哪条路"。就像你脑子里有一张地图，知道去学校走哪条路，去超市走哪条路。

举个例子：你在北京，要给上海的朋友发一个数据包。你的路由器查路由表，发现去上海应该先转发给济南的路由器。济南的路由器再查自己的路由表，发现应该转发给南京。南京再转发给上海。一步一步，数据包就到达目的地了。

在传感器网络中，路由协议的设计更加复杂，因为要考虑节点的能量限制。我们后面的章节会专门学习。

---

**【网络层vs传输层】**

有同学可能会困惑：网络层和传输层都说"端到端传输"，有什么区别？

区别在于：
- **传输层**关注的是**进程到进程**的通信。比如你电脑上同时开着浏览器和微信，传输层要区分数据是给浏览器的还是给微信的。
- **网络层**关注的是**主机到主机**的通信。它只负责把数据包送到目的电脑，至于给哪个程序，它不管。

打个比方：网络层相当于把快递送到你家门口，传输层相当于把快递交到你手上（而不是你室友手上）。

---

**【翻到第12页：数据链路层】**

接下来是**数据链路层**。

数据链路层的功能是确保数据在**单跳**传输中的可靠性。

什么是单跳？就是从一个节点到它直接相连的下一个节点。比如从你的电脑到路由器，这就是一跳。

数据链路层做几件事：

**第一，封装成帧**。数据链路层把网络层的数据包加上头部和尾部，形成**帧**。帧头包含源MAC地址和目的MAC地址，帧尾包含校验信息。

**第二，错误检测与纠正**。通过CRC校验等方法，检测数据在传输过程中有没有出错。如果出错了，就丢弃这个帧，让上层重传。

**第三，流量控制**。防止发送方发太快，接收方来不及处理。

**第四，访问控制**，也叫**MAC协议**。当多个节点共享同一个信道时，MAC协议决定谁可以发送数据，避免冲突。

---

**【MAC地址详解】**

数据链路层使用**MAC地址**来标识设备。

MAC地址是**物理地址**，由48位组成，通常写成六组十六进制数，用冒号分隔，比如00:1A:2B:3C:4D:5E。

MAC地址有两个重要特点：

**第一，全球唯一**。每块网卡在出厂时就被分配了一个唯一的MAC地址，就像身份证号一样。

**第二，不能改变**。MAC地址是烧录在网卡硬件中的，正常情况下无法修改。

---

**【IP地址vs MAC地址】**

现在我们来对比一下IP地址和MAC地址：

| | IP地址 | MAC地址 |
|---|--------|---------|
| 层次 | 网络层 | 数据链路层 |
| 类型 | 逻辑地址 | 物理地址 |
| 长度 | 32位（IPv4） | 48位 |
| 是否可变 | 可变 | 固定 |
| 作用范围 | 全网唯一 | 局域网内有效 |

为什么需要两种地址呢？

打个比方：IP地址就像你的收货地址"北京市海淀区XX路XX号"，是一个逻辑上的位置。MAC地址就像你的身份证号，是你这个人的唯一标识。

快递员送快递时，先根据地址找到你家（IP寻址），然后确认是不是你本人签收（MAC确认）。

---

**【MAC协议简介】**

当多个节点共享同一个无线信道时，如果大家同时发送，信号就会互相干扰，导致冲突。MAC协议就是用来解决这个问题的。

常见的MAC协议有：

**CSMA/CD**：用于有线以太网。先听后发，如果检测到冲突就停止发送，等一会再重试。

**CSMA/CA**：用于无线网络（WiFi）。先听后发，尽量避免冲突。因为无线环境下检测冲突比较困难，所以采用避免策略。

**TDMA**：时分多址。把时间划分成多个时隙，每个节点在自己的时隙内发送，不会冲突。这在传感器网络中很常用。

---

**【翻到第13页：物理层】**

最后是**物理层**，OSI模型的最底层。

物理层负责把数据帧转换成实际的电信号或无线信号，在物理介质上传输。

物理层关注的问题包括：

**第一，传输介质**。用什么来传输信号？可以是双绞线、同轴电缆、光纤，也可以是无线电波。

**第二，信号编码**。怎么把0和1转换成物理信号？比如用高电压表示1，低电压表示0。

**第三，物理接口**。接口长什么样？有几个针脚？每个针脚的功能是什么？

不同的传输介质有不同的特点：

| 介质 | 速度 | 距离 | 抗干扰 | 成本 |
|------|------|------|--------|------|
| 双绞线 | 中等 | 100米 | 一般 | 低 |
| 光纤 | 很快 | 几十公里 | 极好 | 高 |
| 无线 | 取决于频段 | 取决于功率 | 一般 | 低 |

在传感器网络中，主要使用**无线传输**。常用的频段是2.4GHz（Zigbee、WiFi用的频段）和一些低频段（868MHz、915MHz）。无线传感器网络的物理层设计要特别注意**低功耗**，因为节点通常由电池供电。

---

## 七、OSI与TCP/IP对比（10分钟）

**【翻到第14页】**

好，七层模型的每一层我们都讲完了。但是我要告诉大家一个事实：**OSI七层模型虽然经典，但在实际中并没有被广泛采用**。

为什么呢？因为它太复杂了。七层结构设计得很精细，但实现起来太麻烦。

实际上，互联网使用的是**TCP/IP协议栈**，它只有四层。

**【翻到第15-16页】**

大家看这张对比图：

OSI七层和TCP/IP四层的对应关系是：
- OSI的应用层、表示层、会话层，在TCP/IP中合并为一个**应用层**
- OSI的传输层对应TCP/IP的**传输层**
- OSI的网络层对应TCP/IP的**网络层**（也叫网际层）
- OSI的数据链路层和物理层，在TCP/IP中合并为**网络接口层**

所以：
- **OSI是理论参考模型**，用于教学和理解网络原理
- **TCP/IP是实际应用的协议**，互联网就是建立在TCP/IP之上的

那我们为什么还要学OSI呢？因为它的分层思想非常清晰，便于理解每一层的功能。学会了OSI，理解TCP/IP就很容易了。

**对于传感器网络来说**，协议栈通常会进一步简化。因为传感器节点资源有限（处理能力弱、内存小、能量少），没必要实现完整的七层或四层。很多WSN协议栈只有三层：应用层、网络层、MAC层（数据链路层）加物理层。具体的设计我们后面的章节会详细学习。

---

## 八、总结（5分钟）

**【翻到第17页】**

好，现在我们来总结整个2.1节的内容。

OSI七层模型，从下到上：

1. **物理层**：负责实际的比特流传输，关注传输介质和信号编码
2. **数据链路层**：确保单跳传输的可靠性，使用MAC地址，处理帧
3. **网络层**：实现端到端的路由寻址，使用IP地址
4. **传输层**：提供端到端的可靠传输服务，TCP和UDP
5. **会话层**：建立、管理、终止通信会话
6. **表示层**：数据格式转换、加密、压缩
7. **应用层**：直接为应用程序提供网络服务

---

**【数据封装过程】**

最后讲一个重要的概念：**数据封装**。

当发送方要发送数据时，数据从应用层开始，逐层向下传递。每一层都会给数据加上自己的**头部**（有的还加尾部），这个过程叫做**封装**。

- 应用层产生数据
- 传输层加上端口号等信息，形成**段（Segment）**
- 网络层加上IP地址等信息，形成**包（Packet）**
- 数据链路层加上MAC地址等信息，形成**帧（Frame）**
- 物理层把帧转换成**比特流（Bits）**发送出去

接收方收到数据后，从物理层开始，逐层向上传递。每一层去掉自己的头部，把数据交给上一层，这个过程叫做**解封装**。最终，应用层收到的就是原始数据。

这个过程就像套娃：发送时一层一层套上去，接收时一层一层拆开。

---

## 九、随堂练习（5分钟）

**【翻到第18-21页】**

最后我们做几道练习题，检验一下学习效果。

PPT上已经有4道题，我们再补充几道（见练习文档）。

大家看第18页：实际负责数据比特流传输的是哪一层？
（等待回答）对，物理层。物理层是最底层，负责把0和1转换成实际的物理信号传输。

第19页：OSI七层模型中有差错控制的是哪些层？
（等待回答）主要是数据链路层和传输层。数据链路层负责单跳的差错控制，传输层负责端到端的差错控制。

---

## 十、课后思考

今天的课就到这里。给大家留几个思考题：

1. 为什么无线传感器网络不使用完整的七层模型？
2. 在传感器网络中，节能最重要的是哪一层的设计？为什么？
3. 如果让你设计一个温度监测传感器网络的协议栈，你会简化成几层？

下节课我们将学习2.2节——物理层协议，详细介绍无线传感器网络的物理层设计。

下课！
